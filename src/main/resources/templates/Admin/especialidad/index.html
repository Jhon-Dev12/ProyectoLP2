<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{Admin/adminLayout}">
<head>
    <meta charset="UTF-8">
    <title>Listado de Especialidades</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

    <style>
        body { background: #f8f9fa; }
        .table-hover tbody tr:hover { background-color: #eaf3ff; transition: background-color 0.3s ease; }
        .btn-success { transition: all 0.3s ease; }
        .btn-success:hover { transform: scale(1.05); }
        .card { animation: fadeInUp 0.8s ease; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
<section layout:fragment="contenido">

<div class="container mt-5">
    <div class="card shadow-lg animate__animated animate__fadeInUp">
        <div class="card-header bg-primary text-white text-center">
            <h4 class="mb-0"><i class="bi bi-list-check"></i> Listado de Especialidades</h4>
        </div>

        <div class="card-body">
            <div class="text-end mb-3">
                <a th:href="@{/admin/especialidad/new}" 
                   class="btn btn-success animate__animated animate__pulse animate__infinite">
                    <i class="bi bi-plus-circle"></i> Nueva Especialidad
                </a>
            </div>

            <table class="table table-bordered table-hover text-center align-middle shadow-sm">
                <thead class="table-primary">
                    <tr>
                        <th>ID</th>
                        <th>Nombre de Especialidad</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="e : ${especialidades}" class="animate__animated animate__fadeIn">
                        <td th:text="${e.idEspecialidad}"></td>
                        <td th:text="${e.nombreEspecialidad}"></td>
                        <td>
                            <a th:href="@{/admin/especialidad/edit/{id}(id=${e.idEspecialidad})}" 
                               class="btn btn-warning btn-sm">
                                <i class="bi bi-pencil-square"></i> Editar
                            </a>
                            <button class="btn btn-danger btn-sm"
                                    th:attr="data-id=${e.idEspecialidad}"
                                    onclick="confirmarEliminacion(this)">
                                <i class="bi bi-trash3"></i> Eliminar
                            </button>
                        </td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(especialidades)}">
                        <td colspan="3" class="text-muted">No hay especialidades registradas.</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script th:inline="javascript">
/*<![CDATA[*/
let mensaje = /*[[${mensaje}]]*/ null;
if (mensaje !== null) {
    Swal.fire({
        icon: 'success',
        title: 'Éxito',
        text: mensaje,
        timer: 2500,
        showConfirmButton: false
    });
}
/*]]>*/

function confirmarEliminacion(button) {
    const id = button.getAttribute("data-id");
    Swal.fire({
        title: '¿Está seguro?',
        text: 'La especialidad será eliminada definitivamente.',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonText: 'Sí, eliminar',
        cancelButtonText: 'Cancelar',
        confirmButtonColor: '#d33',
        cancelButtonColor: '#3085d6'
    }).then((result) => {
        if (result.isConfirmed) {
            window.location.href = `/admin/especialidad/delete/${id}`;
        }
    });
}
</script>

</section>
</body>
</html>
